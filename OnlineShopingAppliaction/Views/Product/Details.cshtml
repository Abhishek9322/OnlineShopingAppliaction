@model OnlineShopingAppliaction.Models.Product
@{
    ViewData["Title"] = "Product Details";
    var related = ViewBag.RelatedProducts as List<OnlineShopingAppliaction.Models.Product>;
}

<div class="container mt-5" style="background-color:#F8FAFC; border-radius:16px; padding:30px; box-shadow:0 4px 10px rgba(0,0,0,0.05);">
    <div class="row g-4 align-items-center">
        <!-- Product Image -->
        <div class="col-md-5 text-center">
            <img src="@Model.ImagePath" class="img-fluid rounded-3 shadow-sm" alt="@Model.Name" style="max-height:400px; object-fit:cover;">
        </div>

        <!-- Product Details -->
        <div class="col-md-7">
            <h2 class="fw-bold">@Model.Name</h2>
            <h6 class="text-muted">Category: <span class="fw-semibold">@Model.Category?.Name</span></h6>
            <p class="mt-3">@Model.Description</p>

            <h4 class="fw-bold text-dark mb-3">₹@Model.Price</h4>

            <p class="fw-bold @(Model.Stock > 0 ? "text-dark" : "text-danger") mb-2">
                Stock: @Model.Stock
            </p>

            @if (Model.Discount > 0)
            {
                <span class="badge rounded-pill" style="background-color:#D9EAFD; color:#000;">
                     Discount @Model.Discount% OFF
                </span>
            }

            <div class="mt-4 d-flex align-items-center gap-3 flex-wrap">
                @if (Model.Stock > 0)
                {
                    <form asp-controller="Cart" asp-action="AddToCart" method="post" class="d-flex align-items-center gap-3">
                        <input type="hidden" name="productId" value="@Model.Id" />
                        <input type="number" name="quantity" min="1" max="@Model.Stock" value="1"
                               class="form-control rounded-pill shadow-sm" style="width:80px;" />
                        <button type="submit" class="btn btn-lg text-dark fw-semibold"
                                style="background-color:#D9EAFD; border:none; border-radius:50px; padding:10px 20px;">
                            🛒 Add to Cart
                        </button>
                    </form>
                }
                else
                {
                    <span class="badge bg-danger p-2">Out of Stock</span>
                }

                <a href="/Product/Index" class="btn btn-outline-dark btn-lg fw-semibold rounded-pill shadow-sm px-4">
                    ⬅ Back
                </a>
            </div>
        </div>
    </div>

    <!-- Soft Divider -->
    <hr class="my-5" style="border:0; height:1px; background-color:#e5e7eb;">

    <!-- Related Products -->
    <!-- Related Products -->
    @if (related != null && related.Any())
    {
        <h3 class="fw-bold mt-5">Related Products</h3>
        <div class="list-group mt-3">
            @foreach (var product in related)
            {
                <div class="list-group-item d-flex align-items-center p-3 mb-3 shadow-sm rounded"
                     style="background:#fff; border:1px solid #e5e7eb;">

                    <!-- Left: Product Image -->
                    <div class="me-3" style="flex:0 0 120px;">
                        <img src="@(Url.Content(product.ImagePath ?? "~/images/placeholder.png"))"
                             alt="@product.Name"
                             class="img-fluid rounded"
                             style="max-height:100px; object-fit:contain; width:100%;" />
                    </div>

                    <!-- Right: Product Details -->
                    <div class="flex-grow-1">
                        <h6 class="fw-bold mb-1">@product.Name</h6>
                        <p class="text-muted mb-1">₹@product.Price</p>

                        <!-- Product Description -->
                        <p class="text-secondary small mb-2"
                           style="display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical;
                                overflow:hidden; text-overflow:ellipsis; white-space:normal;">
                            @product.Description
                        </p>
                        <a href="/Product/Details/@product.Id"
                           class="btn btn-sm text-dark fw-semibold"
                           style="background-color:#D9EAFD; border:none; border-radius:50px; padding:6px 16px;">
                            View
                        </a>
                    </div>
                </div>
            }
        </div>
    }


</div>

<style>
    /* Related product image box: show full image without cropping */
    .related-card {
        background: #ffffff;
        border-radius: .75rem;
        box-shadow: 0 2px 8px rgba(0,0,0,.05);
    }

    .product-img-box {
        height: 220px; /* consistent height */
        display: flex;
        align-items: center;
        justify-content: center;
        background: #F3F4F6; /* subtle backdrop for letterboxing */
        border-top-left-radius: .75rem;
        border-top-right-radius: .75rem;
    }

        .product-img-box img {
            max-height: 100%;
            max-width: 100%;
            width: auto;
            height: auto;
            object-fit: contain; /* <-- show the whole image */
        }
   

   
    

    
</style>

